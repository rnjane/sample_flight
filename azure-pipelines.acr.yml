pool:
  vmImage: 'ubuntu-16.04'

steps:
  - script: docker build -t $(dockerId)/$(imageName) .

  - script: |
      docker build -t $(dockerId).azurecr.io/$(imageName) .
      docker login -u $(dockerHubId) -p $(pswd) $(dockerId).azurecr.io
      docker push $(dockerId).azurecr.io/$(imageName)
    env:
      pswd: $(dockerHubPassword)
    displayName: 'Build and push Docker image'